name: Render
on:
  push:
    branches: [ main ]

jobs:
  render:
    name: Render
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2

      - name: Setup Kustomize
        uses: imranismail/setup-kustomize@v1

      - name: Render install.yaml
        run: |
          kustomize build source/ > install.yaml
      
      - uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: Commit install.yaml
          file_pattern: install.yaml
